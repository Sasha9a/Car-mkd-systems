<div class="grid mb-4 mt-1 align-items-end">
  <div class="col">
    <div class="grid">
      <div class="col-4 pb-0">
        <p>Категории</p>
      </div>
      <div class="col-4 pb-0">
        <p>Модели</p>
      </div>
      <div class="col-4 pb-0"></div>

      <div class="col-6 lg:col-4 pb-0">
        <car-category-multi-select [categories]="filters.categories"
                                   [(selectedCategories)]="selectedFilters.categories">
        </car-category-multi-select>
      </div>

      <div class="col-6 lg:col-4 pb-0">
        <car-model-car-multi-select [brandCars]="filters.models"
                                    [(selectedModelCars)]="selectedFilters.models">
        </car-model-car-multi-select>
      </div>
    </div>
  </div>

  <div class="p-2">
    <p-button label="Найти" icon="pi pi-search" styleClass="h-auto" [loading]="loading" (onClick)="clickSearch()"></p-button>
  </div>
</div>

<car-spinner *ngIf="loading"></car-spinner>

<div *ngIf="!loading">
  <div class="flex justify-content-end">
    <p-paginator #paginatorStart [rows]="queryParams.limit.value" [totalRecords]="countProducts" (onPageChange)="paginate($event)"></p-paginator>
  </div>

  <div class="my-2 grid">
    <div *ngFor="let product of products | orderBy: '-amount:number' | orderBy: 'isPublic:boolean'" class="col-12 md:col-6 xl:col-4">
      <a routerLink="/product/card/{{ product._id }}" target="_blank">
        <p-card styleClass="h-full">
          <ng-template pTemplate="header">
            <p-image *ngIf="product.images[0]" [src]="('file/' + product.images[0].path) | apiUrl" [alt]="product.images[0].name" width="100%" height="250px"></p-image>
            <p-skeleton *ngIf="!product.images[0]" width="100%" height="250px"></p-skeleton>
          </ng-template>
          <p class="fw-bold mb-2 {{ product.isPublic ? 'text-black' : 'text-red' }}">{{ product.name }}</p>
          <p class="mb-1">
            {{ isPartner() ? 'Розн.цена:' : 'Цена:' }}
            <span class="fw-bold text-blue-500">
              <span *ngIf="product.modifications?.length > 1 && product.category?.isVaried">от </span> {{ (priceInfo[product._id].minPriceProduct || 0) | number }} ₽
            </span>
            <span *ngIf="priceInfo[product._id].isDiscountProduct" style="color: #ce0400">(Есть скидка)</span>
          </p>
          <p *ngIf="isPartner()" class="my-0">
            Парт.цена:
            <span class="fw-bold text-blue-500">
              <span *ngIf="product.modifications?.length > 1 && product.category?.isVaried">от </span> {{ (priceInfo[product._id].minPricePartnerProduct || 0) | number }} ₽
            </span>
            <span *ngIf="priceInfo[product._id].isDiscountPartnerProduct" style="color: #ce0400">(Есть скидка)</span>
          </p>
          <p *ngIf="product.amount" class="greytext text-sm mt-3">В наличии {{ product.amount }} шт.</p>
          <p *ngIf="!product.amount" class="text-red text-sm mt-3">Нет в наличии</p>
        </p-card>
      </a>
    </div>
  </div>

  <div class="flex justify-content-end">
    <p-paginator #paginatorEnd [rows]="queryParams.limit.value" [totalRecords]="countProducts" (onPageChange)="paginate($event)"></p-paginator>
  </div>
</div>
