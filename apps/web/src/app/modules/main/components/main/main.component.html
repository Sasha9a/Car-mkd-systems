<div class="grid mb-4 mt-1">
  <div class="col">
    <div class="grid">
      <div class="col-4 pb-0">
        <car-category-multi-select [categories]="filters.categories"
                                   [(selectedCategories)]="selectedFilters.categories"
                                   [labelInput]="true">
        </car-category-multi-select>
      </div>

      <div class="col-4 pb-0">
        <car-brand-car-multi-select [brandsCar]="filters.brands"
                                    [(selectedBrandsCar)]="selectedFilters.brands"
                                    [labelInput]="true">
        </car-brand-car-multi-select>
      </div>

      <div class="col-4 pb-0">
        <car-model-car-multi-select [modelsCar]="filters.models"
                                    [(selectedModelsCar)]="selectedFilters.models"
                                    [labelInput]="true">
        </car-model-car-multi-select>
      </div>
    </div>
  </div>

  <div class="p-2">
    <p-button label="Найти" icon="pi pi-search" styleClass="h-full" [loading]="loading" (onClick)="loadProducts()"></p-button>
  </div>
</div>

<car-spinner *ngIf="loading"></car-spinner>

<div *ngIf="!loading">
  <div class="flex justify-content-end">
    <p-paginator #paginatorStart [rows]="queryParams.limit.value" [totalRecords]="countProducts" (onPageChange)="paginate($event)"></p-paginator>
  </div>

  <div class="my-2 grid">
    <div *ngFor="let product of products | orderBy: 'isPublic:boolean' | orderBy: 'amount:number'" class="col-12 md:col-6 xl:col-4">
      <a routerLink="/product/card/{{ product._id }}" target="_blank">
        <p-card styleClass="h-full">
          <ng-template pTemplate="header">
            <p-image *ngIf="product.images[0]" [src]="('file/' + product.images[0].path) | apiUrl" [alt]="product.images[0].name" width="100%" height="250px"></p-image>
            <p-skeleton *ngIf="!product.images[0]" width="100%" height="250px"></p-skeleton>
          </ng-template>
          <div class="mx-2">
            <p class="fw-bold mt-1 {{ product.isPublic ? 'text-black' : 'text-red' }}">{{ product.name }}</p>
            <p *ngIf="product.amount" class="greytext text-sm">В наличии {{ product.amount }} шт.</p>
            <p *ngIf="!product.amount" class="text-red text-sm">Нет в наличии</p>
          </div>
        </p-card>
      </a>
    </div>
  </div>

  <div class="flex justify-content-end">
    <p-paginator #paginatorEnd [rows]="queryParams.limit.value" [totalRecords]="countProducts" (onPageChange)="paginate($event)"></p-paginator>
  </div>
</div>
