<h3 class="dividing-header">Товар</h3>

<div class="grid">
  <div class="col-12 xl:col-6">
    <div class="p-fluid">

      <div class="field">
        <label class="fw-bold">Фотографии</label>
        <div *ngIf="product.images?.length" class="mb-3">
          <p-scrollPanel styleClass="w-full" [style]="{ height: '250px' }">
            <p-table [value]="product.images" [reorderableColumns]="true" styleClass="basic-table">
              <ng-template pTemplate="body" let-image let-index="rowIndex">
                <tr *ngIf="toImage(image) as image" [pReorderableRow]="index">
                  <td class="w-3rem">
                    <p>{{ index + 1 }}.</p>
                  </td>
                  <td class="w-3rem">
                    <span class="pi pi-bars" pReorderableRowHandle></span>
                  </td>
                  <td>
                    <car-file [file]="image" class="w-full"></car-file>
                  </td>
                  <td class="w-3rem">
                    <button [disabled]="uploadingFiles"
                            pButton pRipple
                            type="button"
                            icon="pi pi-times"
                            class="p-button-rounded p-button-danger p-button-text"
                            (click)="deleteFile(image)">
                    </button>
                  </td>
                </tr>
              </ng-template>
            </p-table>
          </p-scrollPanel>
        </div>
        <p-fileUpload #fileUpload
                      mode="basic"
                      customUpload="true"
                      chooseIcon="pi-paperclip"
                      chooseLabel="Прикрепить фотографии"
                      [multiple]="true"
                      [disabled]="uploadingFiles"
                      (uploadHandler)="uploadFiles($event)"
                      [auto]="true">
        </p-fileUpload>
      </div>

      <div class="field">
        <label class="fw-bold required-field">Название</label>
        <input type="text" pInputText [ngClass]="{ 'ng-invalid ng-dirty': errors?.name }" [(ngModel)]="product.name">
        <small *ngIf="errors?.name" class="p-error">{{ errors.name | join }}</small>
      </div>

      <div class="field">
        <label class="fw-bold required-field">Количество</label>
        <div class="p-inputgroup">
          <p-inputNumber [(ngModel)]="product.amount" [ngClass]="{ 'ng-invalid ng-dirty': errors?.amount }"></p-inputNumber>
          <span class="p-inputgroup-addon">шт.</span>
        </div>
        <small *ngIf="errors?.amount" class="p-error">{{ errors.amount | join }}</small>
      </div>

      <div class="field">
        <label class="fw-bold required-field">Категория</label>
        <car-category-single-select [categories]="categories"
                                    [class]="errors?.category ? 'ng-invalid ng-dirty' : ''"
                                    [(selectedCategory)]="product.category">
        </car-category-single-select>
        <small *ngIf="errors?.category" class="p-error">{{ errors.category | join }}</small>
      </div>

      <div class="field">
        <label class="fw-bold">Модели автотранспорта</label>
        <car-model-car-multi-select [modelsCar]="modelsCar"
                                    [class]="errors?.modelsCar ? 'ng-invalid ng-dirty' : ''"
                                    [(selectedModelsCar)]="product.modelsCar">
        </car-model-car-multi-select>
      </div>

    </div>
  </div>
</div>
